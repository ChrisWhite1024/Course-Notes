# 应用层协议原理
1. 研发网络应用程序的核心是写出能够运行在不同的端系统和通过网络彼此通信的程序
2. 即将应用软件限制在端系统的方法．促进了大量的网络应用程序的迅速研发和部署
## 互联网应用程序体系结构
1. 从应用程序研发者角度看，网络体系结构是固定的，并为应用程序提供了特定的服务集合
2. 应用程序体系结构 (application architecture) ：由应用程序研发者设计，规定了如何在各端系统上组织该应用程序
### 客户-服务器 (client-server)
1. 总是打开的主机——服务器，它服务于来自许多其他称为客户的主机的请求
2. 服务器具有固定周知的 IP 地址
3. 著名应用程序
	1. Web
	2. FTP
	3. Telnet
	4. 电子邮件
4. 配备大量主机的数据中心 (data center) 常被用于创建强大的虚拟服务器
### P2P
1. 应用程序在间断连接的主机对之间使用直接通信，这些主机对被称为对等方，这些对等方并不为服务提供商所有
2. 具有自扩展性: 每个对等方都由于请求文件产生工作负载，但通过向其他对等方分发文件为系统增加服务能力
## 进程通信
![[Pasted image 20231023191228.png]]
1. 进程 ([process]( https://en.wikipedia.org/wiki/Process_ (computing))): In computing, a process is the instance of a computer program that is being excuted by one or many threads.) 是运行在端系统上的程序，当多个进程运行在相同的端系统上时，它们使用进程间通信机制相互通信
2. 不同端系统上的进程，通过跨越计算机交换报文 (message) 而相互通信
### 客户和服务器进程
1. 在一对进程之间的通信会话场景中，发起通信（即在该会话开始时发起与其他进程的联系）的进程被标识为客户，在会话开始时等待联系的进程是服务器。
### 进程和计算机网络间的接口
1. 进程通过称为套接字 (socket) 的软件接口向网络发送报文和从网络接收报文
	1. 套接是同一台主机内应用层与运输层之间的接口
	2. 由于该套接字是建网络应用程序的可编程接口，因此套接字也称为应用程序和网络之间的应用程序编程接口 (Application Programming Interface, API)  
2. 应用程序开发者对运输层的控制仅限于于
	1. 选择运输层协议
	2. 设定几个参数，如最大缓存和最大报文长度等
### 进程寻址
1. 为了标识接受进程，需要定义两种信息
	1. 主机的地址
	2. 在目的主机中指定接收进程的标识符 (目的地端口号)

##  可供应用程序使用的运输服务
1. 通过研究可用的运输层协议提供的服务，选择一个最能为应用需求提供恰当服务的协议
2. 按照应用程序服务要求分kk类
	1. 可靠数据传输
	2. 吞吐量
	3. 定时
	4. 安全性
### 可靠数据传输
1. 如果一个协议提供了**确保由应用程序的一端发送的数据正确、完全地交付给该应用程序的另一端**的数据交付服务，就认为提供了可靠数据传输服务 (reliable data transfer)
2. 运输层协议向应用程序提供的一个重要服务是**进程到进程**的可靠数据传输
3. 容忍丢失的应用 (loss-tolerant application): 使用的运输层协议不提供可靠数据传输，发送进程的数据可能
### 吞吐量
1. 可用吞吐量：发送进程能够向接收进程交付比特的速率
2. 产生了一种**能够以某种特定的速率提供确保的可用吞吐量**的运输层协议，适用于带宽敏感的应用
3. 带宽敏感的应用 (bandwidth-sensitive application)：具有吞吐量要求的应用程序
4. 弹性应用(elastic application)：能够根据当时可用带宽或多或少地利用可供使用的吞吐量
### 定时
1. 对于交互式实时应用程序有吸引力，如因特网电话、虚拟环境、电话会议和多方游戏
2. 定时保证：发送方注入套接字的每个比特到达接收方的套接字不迟于特定时间限制
### 安全性
1. 运输协议能够为应用程序提供一种或多种安全性服务
2. **发送主机**中运输协议能够加密发送进程传输的所有数据
3. **接收主机**中运输层协议能够将数据交付给接收进程前解密这些数据
4. 运输层协议能够提供机密性、数据完整性和端点鉴别等安全性服务
## 因特网提供的运输服务
1. 因特网为应用程序提供了两个运输层协议，即 UDP 和 TCP
### TCP 服务
1. TCP 服务模型包括**面向连接服务**和**可靠数据传输服务**
2. 面向连接的服务：
	1. 握手过程：在应用层数据报文开始流动之前，TCP 让客户和服务器互相交换运输层控制信息
	2. 握手阶段后，两个进程的套接字之间建立一个 [**全双工**](https://zh.wikipedia.org/zh-cn/%E9%9B%99%E5%B7%A5) 的 TCP 连接 (TCP connection)，当应用程序结束报文发送时，必须拆除该连接
3. 可靠的数据传送服务：
	![[Pasted image 20231031150119.png]]
	 1. 通信进程能够依靠 TCP，无差错、按适当顺序交付所有发送的数据
4. 拥塞控制机制
5. TCP 安全
	1. 安全套接字层 (Secure Sockets Layer，SSL)：经过 SSL 增强的传输控制协议（TCP）不仅具备传统 TCP 的功能，而且还提供了关键的进程到进程安全性服务，包括加密、数据完整性和端点鉴别
	2. SSL 在应用层上实现

### UDP 服务
1. UDP 无连接没有握手过程，没有拥塞控制机制，UDP 协议提供不可靠的数据传送服务
	![[Pasted image 20231031152513.png]]
### 因特网运输协议所不提供的服务
1. 今天的因特网通常能够为时间敏感应用提供满意的服务，但它不能提供任何定时或带宽保证
## 应用层协议
1. 应用层协议 (application-layer protocol) 定义了运行在不同端系统上的应用程序进程如何相互传递报文
2. 应用层协议定义了：
	1. 交换的报文类型
	2. 各种报文类型的语法
	3. 字段的语义
	4. 确定一个进程何时以及如何发送报文，对报文进行响应的规则
3. 应用层协议分为定义在公共域中的协议和专用的协议
4. 应用层协议只是网络应用的重要部分
![[network-protocol.gif]]
# Web 和 HTTP
1. 万维网 (World Web Web)是一个因特网应用，其使用的应用层协议是超文本传输协议(HyperText Transfer Protocol, HTTP) [RFC 1945]() [RFC 2616]()
2. Web 具有按需操作，获取信息便捷等特点
3. Web 页面由对象 (object) 组成，一个对象是一个文件，多数 Web 页面含有一个 HTML 基本文件以及几个引用对象
4. White的静态博客的文件结构
	![[Pasted image 20231031154854.png]]
5. URL 地址由**存放对象的服务器主机名**和**对象的路径名**组成
## HTTP 概况
1. HTTP 定义了 Web 客户向 Web 服务器请求 Web 页面的方式，以及服务器向客户传送 Web 页面的方式
2. HTTP 使用 TCP 作为它的支撑运输协议
3. HTTP 不保存关于客户的任何信息，所以 HTTP 是一个无状态协议(stateless protocol)
### 非持续连接和持续连接
1. 根据每个请求/相应对**经一个单独的 TCP 连接发送还是经相同的 TCP 连接发送**划分
2. 非持续连接 (non-persistent connection)：![[Pasted image 20231031163253.png]] ![[Pasted image 20231031164531.png]] ![[Pasted image 20231031163437.png]] ![[Pasted image 20231031163454.png]] 针对不同的 HostName 建立了两个并行的 TCP 连接 (Q: 怎么观察图 2 和图 3 的两个连接是否是持续的)
	1. 用户可以配置现代浏览器来控制连接的并行度
	2. 往返时间(Round-Trip Time, RTT)：
		1. 一个短分组从客户到服务器然后再返回客户所花费的时间。 
		2. RTT 包括分组传播时延、分组在中间路由器和交换机上的排队时延以及分组处理时延
		3. 点击超链接引起浏览器和 Web 服务器间发起一个 TCP 连接，涉及一次"三次握手"的过程 ![[Pasted image 20231031165751.png]]
		4. 总的响应时间是两个 RTT 加上服务器传输 HTML 文件的时间
	3. 缺点：
		1. 必须为每一个请求的对象建立和维护一个全新的连接
		2. 每一个对象经受两倍 RTT 的交付时延
3. 持续连接(persistent connection)
	1. 在采用 HTTP1.1 持续连接的情况下，服务器在发送响应后保持 TCP 连接打开，在相同的客户与服务器之间，后续的请求和响应报文能够通过相同的连接进行传送 ![[Pasted image 20231031171140.png]]
## HTTP 报文格式
1. 对 HTTP 报文格式的定义