# 基本概念
## 定义
1. 操作系统 (Operation System, OS) 定义：控制和管理整个计算机系统的硬件和软件资源，并合理地组织调度计算机的工作和资源的分配；以提供给用户和其他软件方便的接口和环境；它是计算机系统中最基本的系统软件 ![[Pasted image 20240408191455.png|200]]
## 管理功能
1. 提供的管理功能包括
	1. 处理机 (CPU) 管理
	2. 存储器管理
	3. 文件管理
	4. 设备管理
## 向上层提供服务
1. 向上层提供方便易用的服务体现了封装的思想。将丑陋的硬件功能封装成简单易用的服务，用户无需关注底层系统的细节
	1. GUI (Graphical User Interface)
	2. 联机命令接口：Terminal 等
	3. 脱机命令接口：批处理文件
	4. 程序接口：系统调用，应用程序请求操作系统服务的唯一方式
## 对硬件机器的扩展
1. 将底层硬件组织起来提供更复杂的功能
## 特征
### 并发
1. 两个或多个事件在同一时间间隔内发生，在宏观上同时发生，微观上交替发生
2. 并行：两个或多个事件在同一时刻同时发生
3. 操作系统的并发性指操作系统的程序在宏观上是同时运行着，但微观上是交替运行的
	1. 单核 CPU 同一时刻只能执行一个程序，程序只能并发执行
	2. 多核 CPU 同一时刻能执行多个程序，程序可以并行执行
### 共享
1. 互斥共享方式
2. 同时共享方式：有时宏观上同时，微观上交替访问
3. 并发性与共享性互为存在条件
### 虚拟
1. 把一个物理上的实体变为若干个逻辑上的对应物
2. 时分复用技术 (虚拟处理器技术)
3. 空分复用技术 (虚拟存储技术)
4. 没有并发性，虚拟性就失去了意义
### 异步
1. 系统资源有限，进程的执行以不可预知的速度向前推进，有进程会被阻塞
2. 只有系统拥有并发性，才有可能导致异步性
# 发展历程
## 手工操作阶段
1. 计算机速度快，资源利用率低，计算机大量时间处于空闲状态
![[Pasted image 20240408200542.png]]
## 单道批处理系统
1. 引入脱机输入/输出技术 (外围机 + 磁带)
2. 读取作业花费时间短效率高
3. 程序串行执行，CPU 仍有大量时间等待 I/O
![[Pasted image 20240408200824.png]]
## 多道批处理操作系统
1. 操作系统支持多道程序并发运行
2. 每次向内存中读入多道程序并发执行
3. 资源利用率大幅提升，但没有人机交互功能
![[Pasted image 20240408202050.png|400]]
## 分时操作系统
1. 以时间片为单位轮流为各个用户/作业服务
2. 用户请求可以立刻被响应。解决了人机交互问题
3. 不能优先处理一些紧急任务
## 实时操作系统
1. 能够优先响应一些紧急任务，不需要时间片排队
2. 计算机系统收到外部信号后需要在严格的时限内处理完事件
3. 主要它特点是及时性和可靠性
4. 硬实时操作系统和软实时操作系统
	1. 硬实时操作系统：在绝对严格的规定时间内完成处理
	2. 软实时操作系统：接收偶尔违反时间规定
## 其他操作系统
1. 网络操作系统
2. 分布式操作系统
3. 个人计算机操作系统
# 操作系统运行环境
## 运行机制
参考 https://blog.men.ci/x86-userland-and-syscall/
### 程序
1. 内核程序
	1. 内核是操作系统最重要最核心的部分
	2. 让 CPU 执行一些特权指令
2. 应用程序
### 指令
1. 特权指令
2. 非特权指令
### CPU 状态
1. 内核态
2. 用户态
3. 程序字状态寄存器 (PSW) 储存 CPU 的状态
4. CPU 从内核态切换为用户态需要执行特权指令修改 PSW 的标志位为用户态。意味着操作系统让出 CPU 使用权
5. 用户态到内核态的切换由中断引发
## 中断和异常
### 作用
1. 中断时让操作系态内核夺回 CPU 使用权的唯一途径
2. 中断技术实现了操作系统的并发性
### 类型
1. 内中断 (异常)
	1. 包括陷入 (trap) 、故障 (fault) 和终止 (abort)
		1. 陷入：由陷入指令引起，由应用程序故意引发的
		2. 故障：由错误条件引起的，可能被内核程序修复，如缺页故障
		3. 终止：由致命错误引起，内核程序无法修复改故障，应用程序被终止
	2. CPU 在执行指令时，由指令引发了中断 (指令本身或参数非法)
	3. 应用程序想请求操作系统内核的服务，执行陷入指令引发一个内部中断信号(系统调用通过陷入指令完成)
2. 外中断 (中断)
	1. 时钟中断：由时钟部件发送的中断信号，实现应用程序的上下文切换
	2. I/O 中断：由输入/输出设备发送的中断信号
### 基本原理
1. CPU 根据不同的中断信号，使用不同的中断处理程序来处理，CPU 会根据中断信号查询中断向量表，查找中断程序在内存中的存放位置
## 系统调用
1. 系统调用是应用程序 (程序员) 请求操作系统服务的途径。可以通过系统调用请求操作系统内核的服务![[Pasted image 20240408212837.png]]
2. 